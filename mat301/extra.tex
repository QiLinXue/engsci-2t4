\documentclass{article}
\usepackage{gallian}
\title{MAT301: Extra Topics}
\author{QiLin Xue}
% \lhead{MAT301}
% \rhead{QiLin Xue}
\usetikzlibrary{decorations.markings}
\usepackage{eso-pic}

\usepackage{xcolor}
\usepackage{pagecolor}

\usepackage{calc}%
\usepackage{titlesec}%
\titleformat{\section} {\color{blue1}\Large\bfseries}{\makebox[-4.5em][l]{}}{1em}{}
\titleformat{\subsection} {\color{blue1}\large\bfseries}{\makebox[-5em][l]{}}{1em}{\texorpdfstring{$\blacksquare$}{}\hspace{1mm}}
\titleformat{\subsubsection} {\color{blue1}\normalfont\bfseries}{\makebox[-5em][l]{}}{1em}{\texorpdfstring{$\blacksquare$}{}\hspace{1mm}}
\renewcommand{\qedsymbol}{$\textcolor{blue1}{\blacksquare}$}
\setcounter{tocdepth}{2}
\renewenvironment{proof}{{\bfseries\color{blue1} Proof:}}{\qed}

\begin{document}
\maketitle
\AddToShipoutPictureBG{\AtPageLowerLeft{%
        \color{blue2}\rule{.04\paperwidth}{\paperheight}}}

\tableofcontents
\newpage
\section{Free Abelian Group}
The notion of a free abelian group is important. While during class this was introduced as a tool to solve another problem (classification of finitely generated abelian groups), I will introduce it first to prevent the flow from being broken up in the next section.

Before we define free abelian groups, we need to make a connection between abelian groups and linear algebra.
\subsection{Relationship between Abelian Groups and Vector Spaces}
In this section, we make the connection between free abelian groups and vector spaces. The fact that the group operator of abelian groups is typically written as addition $+$ is suggestive of this relationship.

Specifically, just like how vectors can span a vector space, a linear combination of elements can span a group. For formality, we introduce the following definitions:
\begin{definition}{Set of $\mathbb{Z}$ linear combinations of elements of $S$}
    Let $(A,+)$ be an abelian group. Note that if $S \subseteq A$, then
    \begin{equation*}
        \langle S \rangle = \left\{\sum_{i=1}^{m}k_ia_i:m\in \mathbb{Z}_{\ge 0},\,a_i \in S, k_i \in \mathbb{Z}\right\}
    \end{equation*}
    where the right hand side can be denoted as $\text{span}_{\mathbb{Z}}(S)$, which is the set of all $\mathbb{Z}$ linear combinations of elements of $S$.
\end{definition}
Since empty sets are trivial, we have
\begin{equation*}
    \text{span}_{\mathbb{Z}}(\emptyset) = \{0\}
\end{equation*}
\begin{definition}{Linear Independence, Span, Basis}
    Let $S \subseteq A$.
    \begin{enumerate}
        \item $S$ is linearly independent (over $\mathbb{Z}$) if for any $m\in \mathbb{Z}_{>0}$, $a_1,\dots,a_m \in S$, and $k_1,\dots,k_m \in \mathbb{Z}$,
              \begin{equation*}
                  \sum_{i=1}^{m} k_ia_i = 0 \implies a_1=\cdots=a_m=0,
              \end{equation*}
              or equivalently if every element of $A$ can be written as a $\mathbb{Z}$-linear combination of elements of $S$ in at most one way.
        \item $S$ spans $A$ (over $\mathbb{Z}$) if $A=\spanz(S)$, or equivalently every element of $A$ can be written as a $\mathbb{Z}$-linear combination of elements of $A$ in at least one way.
        \item $S$ is a basis (or $\mathbb{Z}$-basis) of $A$ if $S$ is linearly independent and spans $A$, or equivalently if every element of $A$ can be written as a $\mathbb{Z}$-linear combination of elements of $S$ in exactly one way.
    \end{enumerate}
\end{definition}
\begin{example}
    $e_1,\dots,e_m$ is a basis of $\mathbb{Z}^m$.
\end{example}
\subsection{Definition of Free Abelian Group}
\begin{definition}{Free Abelian Group}
    A free abelian group is an abelian group that has a basis.
    \vspace{2mm}

    A free abelian group of finite rank is an abelian group that has a finite basis.
\end{definition}
\begin{example}
    $\mathbb{Z}^m$ is a free abelian group of finite rank for all $m\in \mathbb{Z}_{\ge 0}$. Note that $\mathbb{Z}^0=\{0\}$.
\end{example}
\begin{example}
    If $\{v_1,\dots,v_m\} \subseteq \mathbb{R}^n$ is linearly independent over $\mathbb{R}$ and $A$ is the subgroup of $\mathbb{R}^n$ generated by $\{v_1,\dots,v_n\}$, i.e. $A=\langle v_1,\dots,v_n\rangle=\spanz(\{v_1,\dots,v_n\})$, then $\{v_1,\dots,v_n\}$ is a $\mathbb{Z}$-basis of $A$, so $A$ is a free abelian group of finite rank.
\end{example}
\begin{example}
    If $\{G_i\}_{i\in I}$ is a set of abelian groups, then
    $$\Oplus{i\in I} G_i := \left\{(g_i)_{i\in I} \in \prod_{i\in I}G_i\,\bigg\vert\,g_i = e_{G_i} \text{ for all but finitely many } i \in I\right\}$$
    is a subgroup of the direct product $\prod_{i\in I} G_i$. Note that we can call $\Oplus{i\in I} G_i$ the direct sum of $\{G_i\}_{i \in I}$.

    If $I$ is infinite and $G_i=\mathbb{Z}$ for all $i\in I$, then $\Oplus{i\in I}G_i = \Oplus{i\in I}\mathbb{Z}$ is a free abelian group that is not of finite rank (it has an infinite basis but no finite basis).
\end{example}
Note that free abelian groups are like vector spaces over $\mathbb{Z}$.
\subsection{Properties of Free Abelian Groups}
\subsubsection{Proposition 1.1: Relationship to $\mathbb{Z}^m$}
\begin{idea}
    A group is a free abelian group of finite rank if and only if it is isomorphic to $\mathbb{Z}^m$ for some $m\in \mathbb{Z}_{\ge 0}$.
\end{idea}
\begin{proof}
    Let $A$ be a group. If $m\in \mathbb{Z}_{\ge 0}$ and $\phi: \mathbb{Z}^m\rightarrow A$ is an isomorphism, then $\{\phi(e_1),\cdots,\phi(e_m)\}$ is a basis of $A$.

    Conversely, if $A$ is a free abelian group of finite rank and $\{a_1,\dots,a_n\}$ is a basis of $A$, then
    \begin{align*}
        \phi: \mathbb{Z}^m &\rightarrow A \\ 
        (k_1,\dots,k_m) & \mapsto k_1a_1 + \cdots + k_ma_m
    \end{align*}
    is an isomorphism.
\end{proof}
\subsubsection{Proposition 1.2: Cardinality of Rank}
\begin{idea}
    Let $A$ be a free abelian group of finite rank. then all bases of $A$ have the same cardinality.
\end{idea}
\begin{proof}
    Let $\{a_1,\dots,a_m\}$ be a basis of $A$.
    
    Let $\{a'_j\}_{j\in J}$ be a basis of $A$. For each $i=1,\dots,m$, there exists a finite subset $S_i \subseteq \{a_j'\}_{j\in J}$ such that $a_i$ is a linear combination of the elements of $S_i$. Let $S=S_1 \cup \cdots \cup S_m$.

    Then $a_1,\dots,a_m$ are all linear combinations of the elements of $S$. Since $\{a_1,\dots,a_m\}$ spans $A$, it follows that every element of $A$ is a linear combination of the elements of $S$, i.e. $S$ spans $A$. Let $a_{j_1},\dots,a_{j_n}$ be the elements of $S$.

    Suppose for a contradiction that $\{a_j'\}_{j\in J}$ is infinite. Then there exists $j\in J$ such that $a_j' \neq a_j,\dots, a'_{j_n}$. There exist $k_1,\dots,j_n\in \mathbb{Z}$ such that
    \begin{equation}
        a_j' = \sum_{i=1}^{n}k_ia_{j_i}',
    \end{equation}
    but this contradicts linearly independence of $\{a_j'\}_{j\in J}$.

    Therefore $\{a_j'\}_{j\in J}$ is finite. Let $a_1',\dots,a_n'$ be the elements of $\{a_j'\}_{j\in J}$. Since $\{a_1,\dots,a_m\}$ spans $A$, for all $i=1,\dots,n$ we can write 
    \begin{equation}
        a_i' = \sum_{j=1}^m M_{ij}a_j
    \end{equation}
    for some $M_{i1},\dots,M_{im}\in \mathbb{Z}$.

    Similarly, since $\{a_1',\dots,a_n'\}$ spans $A$, for all $i=1,\dots,m$ we can write
    \begin{equation}
        a_i = \sum_{j=1}^n N_{ij}a_j'
    \end{equation}
    for some $N_{i1},\dots,N_{in}\in \mathbb{Z}$.

    For all $i=1,\dots,n$, we have
    \begin{align*}
        a_i' &= \sum_{j=1}^m M_{ij}a_j \\ 
        &= \sum_{j=1}^m M_{ij} \sum_{k=1}^n N_{jk}a_k' \\ 
        &= \sum_{j=1}^m\sum_{k=1}^n M_{ij}N_{jk}a_k' \\ 
        &= \sum_{k=1}^n \sum_{j=1}^m M_{ij}N_{jk}a_k' \\ 
        &= \sum_{k=1}^n\left( \sum_{j=1}^m M_{ij}N_{jk}\right)a_k'
    \end{align*}
    Since $\{a_1',\dots,a_n'\}$ is linearly independent, it follows that 
    \begin{equation}
        \left( \sum_{j=1}^m M_{ij}N_{jk}\right) = \delta_{ik}
    \end{equation}
    for all $i,k=1,\dots,n$.

    Similarly, for all $i,k=1,\dots, m$ we have
    \begin{equation}
        \sum_{j=1}^n N_{ij}M_{jk} = \delta_{ik}.
    \end{equation}
    Let $M=[M_{ij}] \in \text{Mat}_{n\times m}(\mathbb{Z})$ and $N=[N_{ij}]\in \text{Mat}_{m\times n}(\mathbb{Z})$.

    Then $MN=I_n$ and $NM=I_m$. Therefore, the $\mathbb{Q}$-linear transformations
    \begin{align*}
        \mathbb{Q}^m &\rightarrow \mathbb{Q}^n \\ 
        x &\mapsto Mx
    \end{align*}
    and 
    \begin{align*}
        \mathbb{Q}^n &\rightarrow \mathbb{Q}^m \\ 
        x &\mapsto Nx
    \end{align*}
    are inverses of each other. Therefore $\mathbb{Q}^m$ and $\mathbb{Q}^n$ are isomorphic vector spaces over $\mathbb{Q}$, so $m=n$.
\end{proof}
\subsection{Definition of Rank}
Therefore, we can remove the assumption that $A$ is of finite rank from the proposition. This also introduces the notion of a rank:
\begin{definition}{Rank of a Free Abelian Group}
    Let $A$ be a free abelian group. The rank of $A$ is the cardinality of some (and hence any) basis of $A$ and is denoted by $\rk(A)$.
\end{definition}
\subsubsection{Proposition 1.3: Finite groups have finite ranks}
\begin{idea}
    Let $A$ be a finitely generated group. Then $A$ is of finite rank if and only if $A$ is a finite group.
\end{idea}
\begin{proof}
    The ``only if'' direction is immediate. Suppose $A$ is a finite group and let $\{g_1,\dots,g_m\}$ be a generating set of $A$. Let $\{a_i\}_{i \in I}$ be a basis of $A$. There is a finite subset $\{a_{i_1},\dots,a_{i_n}\}$ of $\{a_i\}_{i\in I}$ such that
    \begin{equation*}
        \{g_1,\dots,g_m\} \subseteq \spanz\left(\left\{a_{i_1},\dots,a_{i_n}\right\}\right).
    \end{equation*}
    Then
    \begin{equation*}
        A = \spanz(\{g_1,\dots,g_m\}) \subseteq \spanz\left(\left\{a_{i_1},\dots,a_{i_n}\right\}\right) \subseteq A,
    \end{equation*}
    so $\spanz\left(\left\{a_{i_1},\dots,a_{i_n}\right\}\right) = A$. Since $\{a_{i_1},\dots,a_{i_n}\} \subseteq \{a_i\}_{i \in I}$ and $\{a_i\}_{i\in I}$ us linearly independent, it follows that $\{a_{i_1},\dots,a_{i_n}\}$ is linearly independent. Therefore, $\{a_{i_1},\dots,a_{i_n}\}$ is a basis of $A$, so $A$ is of finite rank.
\end{proof}
\vspace{2mm}

\textit{Warning!} Here are a few misconceptions. Take $\mathbb{Z}$ for example. THen:
\begin{itemize}
    \item $\{2,3\}$ is a minimal spanning subset of $\mathbb{Z}$, but it is not a basis as it is linearly dependent.
    \item $\{2,3\}$ spans $\mathbb{Z}$, but does not contain a basis of $\mathbb{Z}$.
    \item $\{2\}$ is a maximal linearly independent subset of $\mathbb{Z}$, but it is not a basis because its span is $2\mathbb{Z} \subsetneq
              \mathbb{Z}$.
    \item $\{2\}$ is linearly independent, but it is not contained in a basis of $\mathbb{Z}$.
\end{itemize}
\subsection{Homomorphisms of Free Abelian Groups}
\subsubsection{Proposition 1.4: Homomorphisms and Bases}
\begin{idea}
    Let $A$ be a free abelian group and let $\{a_i\}_{i\in I}$ be a basis of $A$.
    \vspace{2mm}

    Let $B$ be an abelian group and let $\{b_i\}_{i\in I}$ be a family of elements of $B$.
    \vspace{2mm}

    Then there exists a unique homomorphism $\phi:A\rightarrow B$ such that $\phi(a_i)=b_i$ for all $i\in I$. It is surjective if and only if $\{b_i\}_{i\in I}$ spans $B$, it is injective if and only if $\{b_i\}_{i\in I}$ is linearly independent, and it is an isomorphism iff $\{b_i\}_{i\in I}$ is a basis of $B$.
\end{idea}
Let $A$ be a free abelian group of finite rank $n$. For any basis $\alpha=\{a_1,\dots,a_n\}$ of $A$ there exists a unique isomorphism:
\begin{equation*}
    \theta_\alpha: A \rightarrow \mathbb{Z}^n
\end{equation*}
such that $\theta(a_i)=e_i$ for all $i=1,\dots,n$. Note that:
\begin{itemize}
    \item $\theta_\alpha^{-1}(k_1,\dots,k_n)=\sum_{i=1}^n k_ia_i$
    \item For all $a\in A$, let us write $[a]_\alpha = \theta_\alpha(a) \in \mathbb{Z}^n$.
\end{itemize}
\subsubsection{Proposition 1.5: Matrices and Homomorphisms}
\begin{idea}
    Let $A,B$ be free abelian groups of finite ranks $n$ and $m$, respectively. Let $\alpha=\{a_1,\dots,a_n\}$ be a basis of $A$ and $\beta=\{b_1,\dots,b_m\}$ be a basis of $B$. For all homomorphisms $\phi: A\rightarrow B$ there exists a unique matrix
    \begin{equation*}
        [T]^\alpha_\beta \in \text{Mat}_{m\times n}(\mathbb{Z})
    \end{equation*}
    such that for all $a\in A$ we have
    \begin{equation*}
        [Ta]_\beta = [T]^\alpha_\beta [a]_\alpha.
    \end{equation*}
    Let $C$ be a free abelian group of finite rank $p$ and let $\gamma = \{c_1,\dots,c_p\}$ be a basis of $C$. If $T: A\rightarrow B$ and $S: B\rightarrow C$ are homomorphisms, then
    \begin{equation*}
        [S \circ T]^\alpha_\gamma = [S]^\beta_\gamma [T]^\alpha_\beta
    \end{equation*}
\end{idea}
\begin{proof}
    Let $T:A\rightarrow B$ be a homomorphism. Define
    \begin{equation*}
        [T]^\alpha_\beta = [[Ta_1]_\beta \cdots [Ta_n]_\beta].
    \end{equation*}
    The rest is straightforward.
\end{proof}

In words, this says that we can take any element $a \in A$ to $b \in B$ using the homomorphism $T$ and write it as a vector using the basis of $B$. This is equivalent to first writing $a$ as a vector using the basis of $A$, and multiplying it by some matrix $[T]^\alpha_\beta$ that transforms the vector from an $\alpha$ basis to a $\beta$ basis. Essentially, this is a change of basis matrix. 
\subsubsection{Corollary}
\begin{idea}
    A homomorphism $T:A\rightarrow B$ is an isomorphism if and only if there exists $N\in \text{Mat}_{n\times m}(\mathbb{Z})$ such that
    \begin{equation*}
        [T]^\alpha_\beta n = I_m \text{ and } N[T]^\alpha_\beta = I_n
    \end{equation*}
    in which case $m=n$.
\end{idea}
\subsection{Matrices}
As previously seen, we can make connections between free abelian groups and matrices. Here are a few more important theorems which will help later:
\subsubsection{Invertible Element of \texorpdfstring{$\text{Mat}_{n\times n}(\mathbb{Z})$}{Mat(nxn)(Z)}}
\begin{definition}{Invertible Element of $\text{Mat}_{n\times n}(\mathbb{Z})$}
    Let $n$ be a positive integer and $M \in \text{Mat}_{n\times n}(\mathbb{Z})$. We say that $M$ is an invertible element of $\text{Mat}_{n\times n}(\mathbb{Z})$ if there exists $N\in \text{Mat}_{n\times n}(\mathbb{Z})$ such that
    \begin{equation*}
        MN = I_n = NM,
    \end{equation*}
    in which case $N$ is unique, denoted by $M^{-1}$, and called the \textit{inverse of $M$}. We denote the subset of invertible elements of $\text{Mat}_{n\times n}(\mathbb{Z})$ by $\text{GL}_n(\mathbb{Z})$.
\end{definition}
Note that $M \in \text{Mat}_{n\times n}(\mathbb{Z})$ is invertible if and only if it is invertible in $\text{Mat}_{n\times n}(\mathbb{Q})$ and $M^{-1} \in \text{Mat}_{n\times n}(\mathbb{Z})$.

\subsubsection{Classification of $\text{GL}_n(\mathbb{Z})$}
\begin{idea}
    \begin{equation*}
        \text{GL}_n(\mathbb{Z}) = \{M \in \text{Mat}_{n\times n}(\mathbb{Z}) \vert \det(M) \in \{\pm 1\}
    \end{equation*}
\end{idea}
\begin{proof}
    If $M\in \text{GL}_n(\mathbb{Z})$, then
    \begin{equation*}
        \det(M)\det(M^{-1})=\det(I_n) = 1
    \end{equation*}
    Since $\det(M),\det(M^{-1}) \in \mathbb{Z},$ it follows that $\det(M)=\det(M^{-1})=\pm 1$.

    If $M\in \text{Mat}_{n\times n}(\mathbb{Z})$ and $\det(M) = \pm 1$, then the usual formula for $M^{-1}\in \text{Mat}_{n\times n}(\mathbb{Q})$ shows that $M^{-1}\in \text{Mat}_{n\times n}(\mathbb{Z})$. Thus, $M \in \text{GL}_n(\mathbb{Z}).$
\end{proof}
\subsubsection{Proposition 1.6: Ranks of Subgroups}
\begin{idea}
    For each free abelian group $A$ of finite rank, every subgroup $B$ of $A$ is a free abelian group and
    \begin{equation*}
        \rk{B} \le \rk{A}
    \end{equation*}
\end{idea}
\textit{Remarks:} One can drop the assumption that $A$ is of finite rank.

\begin{proof}
    We will proceed by induction on $m=\rk(A)$.

    If $m \ge 0$ and assume that for each abelian group of rank $m$, every subgroup of it is a free abelian group of rank at most $m$.

    Let $A$ be a free abelian group of rank $m+1$ and let $B \le A$. We can choose a basis $\alpha=\{a_1,\dots,a_{m+1}\}$ of $A$ and define
    \begin{equation*}
        A' = \spanz(\{a_1,\dots,a_m\}) \le A
    \end{equation*}
    Then $A'$ is a free abelian group of rank $m$.
\end{proof}

\subsection{Theorem: Smith Normal Form}
\begin{idea}
    Let $M \in \text{Mat}_{m\times n}(\mathbb{Z})$. There exist a sequence of integral elementary row and column operations that transform $M$ to a matrix of the form
    \begin{equation*}
        \left[
        \begin{array}{c|c}
            \begin{array}{ccc}
                d_1 &        & 0   \\
                    & \ddots &     \\
                0   &        & d_r
            \end{array} & 0 \\
            \hline
            0                          & 0
        \end{array}
        \right],
    \end{equation*}
    where $d_1|\cdots|d_n$ are positive integers. Moreover, $r=\rk(M)$ and for all $i=1,\dots,r$, $d_i=d_i(M)/d_{i-1}(M)$. In particular, $r,d_1,\dots,r_r$ are unique.
\end{idea}
\begin{definition}{$i^\text{th}$ determinant divisor of $M$}
    For $i=1,\dots,\min\{m,n\}$, define
    \begin{equation*}
        d_i(M) := \gcd\{\text{determinants of $i\times i$ minors of $M$.}\}
    \end{equation*}
    and define $d_0(M)=1$. The number $d_i(M)$ is called the $i^\text{th}$ determinant divisor of $M$.
\end{definition}
Note that if $i < \rk(M)$, then $d_i(M) > 0$.
\subsubsection{Integral Elementary Row Operations}
There are three main operations:
\begin{itemize}
    \item To interchange row $i$ and row $j$, this is equivalent to multiplying on the left by $P_{i,j}$.
    \item To multiply row $i$ by $-1$, we multiply on the left by $D_i$.
    \item To replace row $i$ with row $i$ plus $k$ times row $j$, we multiply on the left by $E_{ij}(k)$.
\end{itemize}
Note that if we were to act on the columns instead, the elementary matrices should be multiplied on the right.
\begin{idea}
    The integral elementary matrices $P_{ij},D_i,E_{ij}(k)$ generate the group $\text{GL}_n(\mathbb{Z})$.
\end{idea}
\subsubsection{Smith Normal Form Algorithm}
If $M=0$, we are done. Assume $M \neq 0$.
\begin{enumerate}
    \item Let $\delta(M) = \min\{|M_{ij}| : M_{ij} \neq 0\}$. Choose $M_{ij} \neq 0$ such that $|M_{ij}|=\delta(M)$.
    \item If $M_{ij}$ does not divide an entry in its row, say $M_{i\ell}$, and $M_{i\ell}=gM_{ij}+r$ where $q,r \in \mathbb{Z}$ and $0<r<|M_{ij}|$, then replace $\text{col}_{\ell}$ with $\text{col}_{\ell}-q\text{col}_{j}$:
    \item This results in a matrix $M'$ with $M'_{i\ell}=r$ and $\delta(M') \le r < |M_{ij}| = \delta(M)$. Let $M$ denote $M'$ now. Go to the previous step.
    \item If $M_{ij}$ does not divide an entry in its column, we do the same thing analogous to the previous step.
    \item If $M_{ij}$ divides every entry in its row and column, we can clear the other entries in row $i$ and column $j$ using $M_{ij}$ (i.e. all the other entries are $0$). Let $M$ denote the resulting matrix.
    \item If $M_{ij}$ divides every entry in $M$, skip this step. Otherwise, choose $M_{k\ell}$ such that $M_{ij} \nmid M_{k\ell}.$ Then replace row $i$ with $\text{row}_i+\text{row}_j$. Let $M$ denote the new matrix. Go to the first step.
    \item $M_{ij}$ divides every entry of $M$. Swap row 1 and row $i$ and swap column 1 and column $j$. If $M_{ij} < 0$, multiply row by $-1$.
    
    We look at the resulting matrix $M'$ in the bottom right corner inside the larger matrix. Let $M$ denote $M'$.
    \item Repeat steps 1 to 6 until $M'$ in the previous step is the empty matrix.
\end{enumerate}


\newpage 
\section{Finitely Generated Abelian Groups}
\subsection{Definition of Finitely Generated Abelian Groups}
\begin{definition}{Finitely Generated Groups}
    A group $G$ is finitely generated (FG) if there exists $g_1,\dots,g_n \in G$ such that
    \begin{align*}
        G &= \langle g_1,\dots, g_n\rangle \\ 
        &:= \bigcap_{H \le G,\quad g_1,\dots,g_n \in H} H
    \end{align*}
    or equivalently, every element of $G$ can be written as the product of integer powers of $g_i$.
\end{definition}
\begin{example}
    $D_n$ is finitely generated since $D_n = \langle r,s \rangle$
\end{example}
\begin{example}
    Every cyclic group is finitely generated, so $\mathbb{Z}, \mathbb{Z}/n\mathbb{Z}$ are finitely generated for all $n\in \mathbb{Z}_{\ge 0}$
\end{example}
\begin{example}
    If $G_1,\dots,G_n$ are finitely generated groups, then so is $G_1 \times \cdots \times G_n$.

    Consequently, $\mathbb{Z}^r \times \mathbb{Z}/d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n\mathbb{Z}$ is a finitely generated abelian group for all $r,n \in \mathbb{Z}_{\ge 0}$ and $d_1,\dots,d_n \in \mathbb{Z}_{>0}$.
\end{example}
\subsection{Classification of Finitely Generated Abelian Groups}
\begin{idea}
    Let $A$ be a finitely generated abelian group. Then it can be classified in either of the two (perfectly equivalent) ways:
    \begin{enumerate}
        \item There exists $r,n\in \mathbb{Z}_{\ge 0}$ and positive integers $d_1|\cdots |d_n$ such that 
        \begin{equation}
            A \cong \mathbb{Z}^r \times \mathbb{Z}/d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n\mathbb{Z}.
        \end{equation}
        Moreover, $r,n,d_1,\dots,d_n$ are unique and the $d_i$ are called the \textbf{invariant factors of $A$}
        \item There exist $r,s \in \mathbb{Z}_{\ge 0}$, prime numbers $p_1 < \cdots <p_s$, positive integers $n_1,\cdots, n_s$, and positive integers
        \begin{align*}
            e_{1,1} \ge &\cdots \ge e_{1,n_1} \\ 
            e_{2,1} \ge &\cdots \ge e_{2,n_2} \\ 
            &\,\,\,\,\vdots \\ 
            e_{s,1} \ge &\cdots \ge e_{s,n_s}
        \end{align*}
        such that 
        \begin{align*}
            A &\cong \mathbb{Z}^r \times \mathbb{Z}/p_1^{e_{1,1}}\mathbb{Z} \times \cdots \times \mathbb{Z}/p_1^{e_{1,n_1}}\mathbb{Z} \times \cdots \times \mathbb{Z}/p_s^{e_{s,1}}\mathbb{Z} \times \cdots \times \mathbb{Z}/p_s^{e_{s,n_s}}\mathbb{Z} \\ 
            &\cong \mathbb{Z}^r \times \prod_{j=1}^{n_1}\mathbb{Z}/p_1^{e_{i,j}}\mathbb{Z} \times \cdots \times \prod_{j=1}^{n_s}\mathbb{Z}/p_s^{e_{s,j}}\mathbb{Z}.
        \end{align*}
        Moreover, $r$ and $s$, and the $p_i,n_i$ and $e_{i,j}$ are all unique.
        \vspace{2mm}

        More concisely, there exist $r,t\in \mathbb{Z}_{>0}$ and prime powers $q_1\le \cdots \le q_t$ such that 
        \begin{equation}
            A \cong \mathbb{Z}^r \times \mathbb{Z}/q_1\mathbb{Z} \times \cdots \times \mathbb{Z}/q_t\mathbb{Z}
        \end{equation}
        and $r,t,q_i$ are unique. Note the $q_i$ are known as the \textbf{elementary divisors of $A$.}
    \end{enumerate}
\end{idea}
Note that $A$ is finite if and only if $r=0$. Therefore, the theorem specializes to the classification of finite abelian groups. To prove this, we will do the following:
\begin{enumerate}
    \item Show that an isomorphism as in (1) exists by reducing the problem to a result in linear algebra.
    \item We will construct an isomorphism as in (2) from an isomorphism as in (1), and vice versa.
\end{enumerate}
\subsubsection{Lemma: Homomorphism from $\mathbb{Z}^m \rightarrow A$}
\begin{idea}
    Let $(A,+)$ be an abelian group. Then $A$ is finitely generated if and only if there exists $m\in \mathbb{Z}_{>0}$ and a surjective homomorphism $\phi:\mathbb{Z}^m \rightarrow A$.
\end{idea}
\begin{proof}
    Suppose that there exist $m\in \mathbb{Z}_{>0}$ and a surjective homomorphism $\phi: \mathbb{Z}^m \rightarrow A$.

    Let $a \in A$. THen, there exists $(x_1,\dots,x_m)\in \mathbb{Z}^m$ such that $a = \phi(x_1,\dots,x_m)$. For $i=1,\dots,m$, let
    \begin{equation}
        e_i = (0,\dots,0,1,0,\dots,0)\in \mathbb{Z}^m
    \end{equation}
    where the $i^\text{th}$ entry is a $1$. Then $(x_1,\dots,x_m) = \sum_{i=1}^m x_ie_i$. Therefore
    \begin{equation}
        a = \phi\left(\sum_{i=1}^mx_ie_i\right) = \sum_{i=1}^m x_i \phi(e_i).
    \end{equation}
    Therefore $A = \langle \phi(e_1),\dots,\phi(e_n)\rangle$, so $A$ is finitely generated.

    To show the converse, suppose $A$ is finitely generated and let $a_1,\dots,a_m\in A$ such that $A = \langle a_1,\dots, a_m\rangle$. Define 
    \begin{equation}
        \phi: \mathbb{Z}^m \rightarrow A
    \end{equation}
    by $\phi(x_1,\dots,x_m)=x_1a_1+\cdots + x_ma_m$. Then $\phi$ is a surjective homomorphism.
\end{proof}
\subsection{First Reduction}
Let $A$ be a finitely generated abelian group and let $\phi: \mathbb{Z}^m \rightarrow A$ be a surjective homomorphism. Let $B = \ker\phi \le \mathbb{Z}^m$. By the $1^\text{st}$ isomorphism theorem, we have $A \cong \mathbb{Z}^m/B$. If:
\begin{align*}
    B &= d_1\mathbb{Z}\times \cdots \times d_n\mathbb{Z} \times \{0\} \times \cdots \times \{0\} \\ 
    &\le \underbrace{\mathbb{Z} \times \cdots \times \mathbb{Z}}_{n} \times \underbrace{\mathbb{Z} \times \mathbb{Z} \times \mathbb{Z}}_{r:=m-n} = \mathbb{Z}^m
\end{align*}
then
\begin{align*}
    A &\cong \mathbb{Z}^m/B \\ 
    &\cong \frac{{\mathbb{Z} \times \cdots \times \mathbb{Z}} \times {\mathbb{Z} \times \mathbb{Z} \times \mathbb{Z}}}{d_1\mathbb{Z}\times \cdots \times d_n\mathbb{Z} \times \{0\} \times \cdots \times \{0\}} \\ 
    &\cong \mathbb{Z}/d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n\mathbb{Z} \times \mathbb{Z}/\{0\} \times \mathbb{Z}/\{0\} \\ 
    &\cong \mathbb{Z}/d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n\mathbb{Z} \times \mathbb{Z} \times \cdots \times \mathbb{Z} \\ 
    &= \mathbb{Z}d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n\mathbb{Z} \times \mathbb{Z}^r \\ 
    &\cong \mathbb{Z}^r \times \mathbb{Z}/d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n \mathbb{Z}
\end{align*}
where the third line is a result in the exercise sheet. However, $B$ might not have this form.

\subsubsection{Lemma}
\begin{idea}
    If $\phi: G_1\rightarrow G_2$ is an isomorphism, $N_1 \trianglelefteq G_1$, $N_2 \trianglelefteq G_2$, and $\phi(N_1)=N_2$, then
    \begin{align*}
        G_1/N_1 \rightarrow G_2/N_2 \\ 
        g_1N_1 \mapsto \phi(g_1)N_2
    \end{align*}
    is a well defined isomorphism.
\end{idea}
We can actually make this result more general:

\begin{idea}
    Let $\phi: G_1\rightarrow G_2$ be a homomorphism and $N_2 \trianglelefteq G_2$. Then $\phi^{-1}(N_2) \trianglelefteq G_1$ and the map 
    \begin{align*}
        G_1/\phi^{-1}(N_1) \rightarrow G_2/N_2 \\ 
        g_1\phi^{-1}(N_1) \mapsto \phi(g_1)N_2
    \end{align*}
    is a well defined injective homomorphism with $\im{\phi}=\phi(G_1)N_2/N_2$.
\end{idea}
To prove that an inversion factor decomposition exists, it suffices to construct an isomorphism $\mathbb{Z}^m \rightarrow \mathbb{Z}^m$ that maps $B$ to $d_1\mathbb{Z} \times \cdots \times d_n\mathbb{Z} \times \{0\} \times \cdots \times \{0\},$ where $d_1,\dots,d_n \in \mathbb{Z}_{>0}$ such that $d_1|\cdots|d_n$. Indeed, if this is the case then from the first reduction section, we would have shown that
\begin{equation}
    A \cong \mathbb{Z}^r \times \mathbb{Z}/d_1\mathbb{Z} \times \mathbb{Z}/d_n\mathbb{Z}
\end{equation}
To construct an isomorphism $\mathbb{Z}^m \rightarrow \mathbb{Z}^m$ that maps $B$ to the prescribed subgroup of $\mathbb{Z}^m$, we need a better understanding of group isomorphisms to $\mathbb{Z}^m$, especially their subgroups and isomorphisms between them. This leads us to the study of free abelian groups, which we have done in the first section.

\subsection{Second Reduction}
Let $A$ be a finitely generated abelian group, $\phi: \mathbb{Z}^m \rightarrow A$ is a surjective homomorphism, and $B=\ker\phi \le \mathbb{Z}^m$. Recall that it suffices to construct an isomorphism $\mathbb{Z}^m \rightarrow \mathbb{Z}^m$ that maps $B$ to $$d_1\mathbb{Z} \times \cdots \times d_n\mathbb{Z} \times \{0\} \times \cdots \times \{0\} \le \mathbb{Z}^m$$
for some positive integers $d_1|\cdots | d_n$.

Since $B \le \mathbb{Z}^m$, we now know that $B$ is a free abelian group of rank $n \le m$. Let $r=m-n$. It then suffices to prove the following theorem (too lazy to write proof, can be found in Lec 20):
\begin{idea}
    Let $C$ be a free abelian group of finite rank $m$ and let $B \le C$. Then $B$ is a free abelian group of rank at most $m$. Let $n=\rk(B) \le m$.
    \vspace{2mm}

    Then, there exists bases $\beta =\{b_1,\dots,b_n\}$ of $B$ and $\gamma=\{c_1,\dots,c_m\}$ of $C$ and positive integers $d_1|\cdots | d_n$ such that
    \begin{equation*}
        b_i = d_i c_i
    \end{equation*}
    for all $i=1,\dots, n$. Moreover, $d_1,\dots,d_n$ are unique.
\end{idea}
Indeed, suppose that this theorem holds and apply it to $B=\ker\phi \le \mathbb{Z}^n = C$. The isomorphism
\begin{equation*}
    \mathbb{Z}^m = C \xrightarrow{[\cdot]_\gamma} \mathbb{Z}^m
\end{equation*}
maps $b_i = d_ic_i$ to $d_ie_i$ for all $i=1,\dots, n$. Therefore, the isomorphism maps $B$ to $d_1\mathbb{Z} \times \cdots \times d_n\mathbb{Z}\times \{0\} \times \cdots \times \{0\}$.

We will prove a more general theorem.
\begin{idea}
Let $B$ and $C$ be free abelian groups of finite ranks $n$ and $m$, respectively. Let $\Psi: B\rightarrow C$ be a homomorphism.
\vspace{2mm}

Then there exists bases $\beta=\{b_1,\dots,b_n\}$ of $B$ and $\gamma=\{c_1,\dots,c_m\}$ of $C$, there exists a positive integer $r \le m,n$ and there exists positive integers $d_1|\cdots | d_r$ such that
\begin{equation*}
    \Psi(b_i) = \begin{cases}
        d_ic_i & 1\le i \le r \\
        0 & r < i \le n
    \end{cases}
\end{equation*}
or equivalently
\begin{equation*}
    [\Psi]^\beta_\gamma =
    \left[
        \begin{array}{c|c}
            \begin{array}{ccc}
                d_1 &        & 0   \\
                    & \ddots &     \\
                0   &        & d_r
            \end{array} & 0 \\
            \hline
            0                          & 0
        \end{array}
        \right]
\end{equation*}
Moreover, $r,d_1,\dots,d_r$ are unique.
\end{idea}
Let $\beta_0,\gamma_0$ be bases of $B,C$, respectively. The theorem is equivalent to the assertion that there exists matrices $P\in \text{GL}_m(\mathbb{Z})$, $Q\in \text{GL}_n(\mathbb{Z})$ such that
\begin{equation*}
    P[\Psi]_{\gamma_0}^{\beta_0}Q =     \left[
        \begin{array}{c|c}
            \begin{array}{ccc}
                d_1 &        & 0   \\
                    & \ddots &     \\
                0   &        & d_r
            \end{array} & 0 \\
            \hline
            0                          & 0
        \end{array}
        \right]
\end{equation*}
for some positive integers $d_1|\cdots |d_r$, and $r,d_1,\dots,d_r$ are unique. It turns out that slightly more is true.
\subsection{Uniqueness}
Now that we have shown it is possible to create an invariant factor decomposition, let us show this is unique. To do this, we make use of torsion subgruops.
\subsubsection{Torsion Subgroup}
\begin{definition}{Torsion subgroup of $A$}
    Let $A$ be an abelian group. For each $n\in \mathbb{Z}_{>0}$, we define the $n$-torsion subgroup of $A$ to be
    \begin{equation*}
        A[n] := \{a\in A: na = 0\}
    \end{equation*}
    we define the $n$-power torsion subgroup of $A$ to be
    \begin{equation*}
        A[n^\infty] := \left\{a\in A: n^k a = 0 \text{ for some } k \in \mathbb{Z}_{\ge 0}\right\}
    \end{equation*}
    and we define the torsion subgroup of $A$ to be 
    \begin{equation*}
        \text{Tor}(A) := \left\{a\in A: ma=0 \text{ for some } m\in \mathbb{Z}_{>0}\right\} = \bigcup_{n\in \mathbb{Z}_{>0}}A[n].
    \end{equation*}
\end{definition}
\subsubsection{Proposition 2.1 Isomorphisms of Torsion Groups}
\begin{idea}
    Let $A$ be a finitely generated group. If $A \cong \mathbb{Z}^r \times T$, where $r \in \mathbb{Z}_{\ge 0}$ and $T$ is a finite abelian group, then $T \cong \text{Tor}(A)$ and $\mathbb{Z}^r \cong A/\text{Tor}(A)$.
    \vspace{2mm}

    Consequently, $T$ is unique up to isomorphism and $r$ is unique.
\end{idea}
\begin{proof}
    First, note that if $\phi: B\rightarrow C$ is an isomorphism between abelian groups, then $\phi(\text{Tor}B)=\text{Tor}C$, so $\phi$ restricts to an isomorphism $\phi: \Tor B \rightarrow \Tor C$.

    Let $\phi: A\rightarrow \mathbb{Z}^r \times T$ be an isomorphism as in the proposition statement. 

    Since $\Tor(\mathbb{Z}^r \times T) = \{(0,\dots,0)\} \times T \cong T$, we have $\Tor(A) \cong \{0\} \times T \cong T$.

    Also since $\phi(\Tor A)= \{0\} \times T$, the map
    \begin{align*}
        A/\Tor A &\rightarrow \mathbb{Z}^r \times T/(\{0\} \times T) \\ 
        a + \Tor A &\mapsto \phi(a) + (\{0\} \times T)
    \end{align*}
    is a well defined isomorphism. Therefore,
    \begin{align*}
        A/\Tor A & \cong \mathbb{Z}^r \times T/(\{0\} \times T) \\ 
        &\cong \mathbb{Z}^r/\{0\} \times T/T \\ 
        &\cong \mathbb{Z}^r \times \{0\} \\ 
        &\cong \mathbb{Z}^r
    \end{align*}
\end{proof}
\subsubsection{Proposition 2.2: Isomorphisms of $n$-power Torsion Groups}
\begin{idea}
    Let $A$ be a finitely generated abelian group. If $A \cong \mathbb{Z}^r \times P \times B$, where $r \in \mathbb{Z}_{\ge 0}$, $P$ is a finite abelian group with $|P|=p^k$ for some prime $p$, and $B$ is a finite abelian group with $p\nmid |B|$, then
    \begin{equation*}
        A[p^\infty] \cong P
    \end{equation*}
\end{idea}
\subsubsection{Proposition 2.3: Uniqueness}
To prove uniqueness of the invariant factor and elementary divisor decompositions, it remains for us to prove that $d_1,\dots,d_n$ and $e_{i,1},\dots,e_{i,n_i}$ are unique for each $i=1,\dots, s$.
\begin{idea}
    Let $A$ be a finite abelian group. If $A \cong \mathbb{Z}/a_1\mathbb{Z} \times \cdots \times \mathbb{Z}/a_n \mathbb{Z}$ for positive integers $a_1|\cdots | a_n,$ then $a_1,\dots,a_n$ are uniquely determined by $A$.
\end{idea}
To prove this, we make use of the following lemma:
\begin{idea}
    If $a\in \mathbb{Z}$, $b\in \mathbb{Z}_{>0}$, then
    \begin{equation*}
        a(\mathbb{Z}/b\mathbb{Z}) = \gcd(a,b)\mathbb{Z}/b\mathbb{Z}
    \end{equation*}
\end{idea}
\begin{proof}
    We have
    \begin{align*}
        a(\mathbb{Z}/b\mathbb{Z}) &= \{a(n+b\mathbb{Z}): n\in \mathbb{Z} \} \\ 
        &= \{an+b\mathbb{Z} : n \in \mathbb{Z}\}
        &= \{x+b\mathbb{Z} : x\in a\mathbb{Z}\} \\ 
        &= \text{ image of $a\mathbb{Z}$ under the quotient homomorphism }\mathbb{Z} \rightarrow \mathbb{Z}/b\mathbb{Z} \\ 
        &= (a\mathbb{Z}+b\mathbb{Z})/b\mathbb{Z} \\ 
        &= \gcd(a,b)\mathbb{Z}/b\mathbb{Z}
    \end{align*}
    where the last line follows from Bezout's Lemma.
\end{proof}

and another lemma:
\begin{idea}
    Let $p$ be a prime and let $b\in \mathbb{Z}_{>0}$, for all $e\in \mathbb{Z}_{>0}$, we have
    \begin{equation*}
        \frac{p^{e-1}(\mathbb{Z}/b\mathbb{Z})}{p^e(\mathbb{Z}/b\mathbb{Z})} \cong \begin{cases}
            \{0\} & p^e \nmid b \\ 
            \mathbb{Z}/p\mathbb{Z} & p^e | b
        \end{cases}
    \end{equation*}
\end{idea}
% Let $m,n \in \mathbb{Z}_{>0}$ with $m|n$. For any gruop $(G,\cdot)$, we have $G^n = \{g^n: g\in G\} = \{\left(g^{n/m}\right)^m : g\in G\} \subseteq G^m$. If $(A,+)$ is an abelian group written additively, then the above is written as $mA \subseteq nA$.
\begin{proof}
    Let $e\in \mathbb{Z}_{>0}$. By Lemma 1, we have
    \begin{equation*}
        p^{e-1}(\mathbb{Z}/b\mathbb{Z}) = \gcd(p^{e-1},b)\mathbb{Z}/b\mathbb{Z}
    \end{equation*}
    and
    \begin{equation*}
        p^e(\mathbb{Z}/b\mathbb{Z}) = \gcd(p^e,b)\mathbb{Z}/b\mathbb{Z}
    \end{equation*}
    Suppose $p^e \nmid b$. Then $\gcd(p^e,b)=\gcd(p^{e-1},b)$. Therefore $p^{e-1}(\mathbb{Z}/b\mathbb{Z})=p^e(\mathbb{Z}/b\mathbb{Z})$, and
    \begin{equation*}
        \frac{p^{e-1}(\mathbb{Z}/b\mathbb{Z})}{p^e(\mathbb{Z}/b\mathbb{Z})} \cong \{0\}
    \end{equation*}
    Suppose $p^e \mid b$. Then $\gcd(p^e,b)=p^e$ and $\gcd(p^{e-1},b)=p^{e-1}$. Therefore:
    \begin{align*}
        \frac{p^{e-1}(\mathbb{Z}/b\mathbb{Z})}{p^e(\mathbb{Z}/b\mathbb{Z})} &= \frac{p^{e-1}\mathbb{Z}/b\mathbb{Z}}{p^e\mathbb{Z}/b\mathbb{Z}} \\ 
        &\cong p^{e-1}\mathbb{Z}/p^e\mathbb{Z} 
    \end{align*}
    where we have used the third isomorphism theorem. The map 
    \begin{align*}
        \mathbb{Z}/p\mathbb{Z} &\rightarrow p^{e-1}\mathbb{Z}/p^e\mathbb{Z} \\ 
        n+p\mathbb{Z} \mapsto p^{e-1}n+p^e\mathbb{Z}
    \end{align*}
    is a well defined isomorphism (consider $\mathbb{Z} \rightarrow p^{e-1}\mathbb{Z}/p^e\mathbb{Z}$ and $n \mapsto p^{e-1}n+p^e\mathbb{Z}$ and apply the first isomorphism theorem).

    Therefore, 
    \begin{equation*}
        p^{e-1}\mathbb{Z}/p^e\mathbb{Z}  \cong \mathbb{Z}/p\mathbb{Z}
    \end{equation*}
    and we are done.
\end{proof}

Let $\phi: A \rightarrow \mathbb{Z}/a_1\mathbb{Z} \times \cdots \times \mathbb{Z}/a_n\mathbb{Z} =: B$ be an isomorphism, where $a_1|\cdots | a_n$ are positive integers.

Let $p$ be a prime and $e\in \mathbb{Z}_{>0}$. Then $\phi(p^{e-1}A)=p^{e-1}B$ and $\phi(p^eA)=p^eB$. Therefore, the map
\begin{align*}
    p^{e-1}A/p^eA &\rightarrow p^{e-1}B/p^eB \\ 
    x+p^eA &\mapsto \phi(x) + p^eB
\end{align*}
is an isomorphism. We have
\begin{align*}
    \frac{p^{e-1}A}{p^eA} &\cong \frac{p^{e-1}B}{p^eB} \\ 
    &= \frac{p^{e-1}(\mathbb{Z}/a_1\mathbb{Z} \times \cdots \times \mathbb{Z}/a_n\mathbb{Z})}{p^e(\mathbb{Z}/a_1\mathbb{Z} \times \cdots \times \mathbb{Z}/a_n \mathbb{Z})} \\ 
    &= \frac{p^{e-1}(\mathbb{Z}/a_1\mathbb{Z})\times \cdots \times p^{e-1}(\mathbb{Z}/a_n\mathbb{Z})}{p^e(\mathbb{Z}/a_1\mathbb{Z})\times \cdots \times p^e(\mathbb{Z}/a_n\mathbb{Z})} \\ 
    &\cong \frac{p^{e-1}(\mathbb{Z}/a_1\mathbb{Z})}{p^e(\mathbb{Z}/a_1\mathbb{Z})} \times \cdots \times \frac{p^{e-1}(\mathbb{Z}/a_n\mathbb{Z})}{p^e(\mathbb{Z}/a_n\mathbb{Z})} \\ 
    &\cong (\mathbb{Z}/p\mathbb{Z})^r
\end{align*}
where $r$ is the number of $i\in \{1,\dots,n\}$ such that $p^e | a_i$.

Let $i\in \{1,\dots,n\}$.

If $p^e | a_i$, then $p^e | a_i, a_{i+1},\dots, a_n$, so there are at least $n-(i-1)$ elements $j\in \{1,\dots,n\}$ such that $p^e | a_j$ and therefore 

$$r \ge n - (i-1).$$

If $p^e \nmid a_i$, then $p^e \nmid a_1,\dots, a_i$, so $r \le n-i$.

Therefore $p^e| a_i$ if and only if $p^{e-1}A/p^eA \cong (\mathbb{Z}/p\mathbb{Z})^r$ for some $r \ge n-(i-1)$ if and only if $|p^{e-1}A/p^eA| = p^r$ for some $r \ge n-(i-1)$.

Thus the prine powers that divide each $a_i$ are determined by $A$ and therefore the $a_i$ are determined by $A$.
\subsection{Elementary Divisors to Inversion Factors}
Now we wish to show we can create an isomorphism between the two ways to decompose an abelian group, and thus show that they are equivalent.

Suppose that $A \cong \mathbb{Z}^r \times \prod_{i=1}^s \prod_{j=1}^{n_i} \mathbb{Z}/(p_i^{e_{i,j}}\mathbb{Z})$. Recall that $p_1<\cdots < p_S$ and $e_{i,1}\ge \cdots \ge e_{i,n_i}$ for all $i=1,\dots, s$.

Let $n=\underset{1\le i \le s}{\max}(n_i)$. For each $i\in \{1,\dots, s\},$ if $n_i < n$, define $e_{ij}=0$ for all $n_i < j \le n$. Then
\begin{align*}
    A &\cong \mathbb{Z}^r \times \prod_{i=1}^s \prod_{j=1}^n \mathbb{Z}/(p_i^{e_{i,j}}\mathbb{Z}) \\ 
    &\cong \mathbb{Z}^r \times \prod_{j=1}^n \prod_{i=1}^s \mathbb{Z}/(p_i^{e_{i,j}}\mathbb{Z}). 
\end{align*}
Now,
\begin{equation*}
    \prod_{i=1}^s \mathbb{Z}/(p_i^{e_{i,j}}\mathbb{Z}) \cong \mathbb{Z}/(p_1^{e_{1,j}}\cdots p_n^{e_{n,j}}\mathbb{Z})
\end{equation*}
for all $j=1,\dots, n$.

Define $d_i = p_1^{e_{1,n-i+1}\cdots p_n^{e_{n,n-i+1}}}$ for $i=1,\dots, n$. Then $d_1|\cdots | d_n$ and
\begin{equation*}
    A \cong \mathbb{Z}^r \times \mathbb{Z}/d_1\mathbb{Z} \times \cdots \times \mathbb{Z}/d_n\mathbb{Z}
\end{equation*}
\end{document}